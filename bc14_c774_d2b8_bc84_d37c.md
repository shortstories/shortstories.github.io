# 바이트 버퍼
- Pure Java에서 Buffer와 그 하위 클래스들을 제공함에도 불구하고 네티에서는 자체적인 바이트 버퍼 API를 사용

## 네티 바이트 버퍼
### 특징
1. 별도의 읽기 인덱스와 쓰기 인덱스
2. flip 메서드 없이 읽기 쓰기 가능
3. 가변 바이트 버퍼
4. 프레임워크 레벨의 바이트 버퍼 풀 제공
5. 복합 버퍼
6. Java ByteBuffer와 호환됨
7. 자료형에 따른 클래스를 제공하지 않고 별도의 method로 제공


### 생성
- 생성을 위해 ByteBufAllocator 인터페이스 사용 (구현체는 PooledByteBufAllocator)
- Pooled의 경우 `ByteBufAllocator.DEFAULT.heapBuffer()`, `ByteBufAllocator.DEFAULT.directBuffer()` 호출로 생성
- Unpooled의 경우 `Unpooled.buffer()`, `Unpooled.directBuffer()` 호출로 생성

**종류**

|  | Pooled | Unpooled |
| -- | -- | -- |
| Direct Buffer | PooledDirectByteBuf | UnpooledDirectByteBuf |
| Heap Buffer | PooledHeapByteBuf | UnpooledHeapByteBuf |

### 사용
**읽기 쓰기**
- `write{Type}`
- `read{Type}`

**크기 조절**
- capacity : 현재 저장된 바이트 크기보다 작게 조절하면 뒷부분이 잘림

### 풀링
- 객체의 재활용이 가능하여 GC 횟수 감소
- 보통 Direct Allocating, Deallocating 비용이 비싸기 때문에 사용됨
- `retain` : 자체적인 reference counting 증가
- `release` : 자체적인 reference counting 감소. 만약에 count가 0이라면 객체를 Deallocating. 객체를 할당 해제하는 것은 마지막으로 접근한 지점에서 이루어짐

